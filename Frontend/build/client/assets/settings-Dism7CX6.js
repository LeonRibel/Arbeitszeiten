import{w as T,a as $,r}from"./chunk-FGUA77HG-DXx5pbNv.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{H as E}from"./heading-Cc1lyjB0.js";import{c as D}from"./clsx-B-dksMZM.js";import{F as i,L as c,I as m}from"./input-C_GS3zNF.js";import{B as P}from"./button-Bh0dwTEB.js";import{u as F}from"./useTranslation-DlJuNdwr.js";import"./link-DeWrvwtq.js";import"./index-Bon2tSw_.js";function w({soft:u=!1,className:s,...n}){return e.jsx("hr",{role:"presentation",...n,className:D(s,"w-full border-t",u&&"border-zinc-950/5 dark:border-white/5",!u&&"border-zinc-950/10 dark:border-white/10")})}const V=T(function(){const{t:s,i18n:n}=F(),[j]=$(),[h,v]=r.useState(""),[N,x]=r.useState(!1),[g,p]=r.useState(""),[d,z]=r.useState(""),[l,y]=r.useState(""),[a,k]=r.useState(()=>localStorage.getItem("themeMode")||"system"),[f,b]=r.useState(()=>localStorage.getItem("language")||"de");r.useEffect(()=>{const t=localStorage.getItem("language");t&&n.language!==t&&(n.changeLanguage(t),b(t))},[n]);const S=t=>{n.changeLanguage(t),localStorage.setItem("language",t),b(t)};r.useEffect(()=>{const t=j.get("token");t&&(p(t),x(!0))},[j]),r.useEffect(()=>{const t=()=>{a==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"):a==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")};if(t(),localStorage.setItem("themeMode",a),a==="system"){const o=window.matchMedia("(prefers-color-scheme: dark)"),C=()=>t();return o.addEventListener("change",C),()=>o.removeEventListener("change",C)}},[a]);const L=async()=>{if(!h)return alert(s("enterUsername"));try{const t=await fetch("http://localhost/Passwort/Vergessen",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:h})}),o=await t.json();t.ok?(alert(s("tokenSent")),x(!0)):alert(s("tokenError")+": "+(o.message||""))}catch(t){console.error(t),alert(s("tokenError"))}},M=async()=>{if(!g||!d||!l)return alert(s("fillAllFields"));if(d!==l)return alert(s("passwordMismatch"));try{const t=new FormData;t.append("password",d),t.append("password_bestaetigen",l),(await fetch(`http://localhost/passwort-vergessen/token?token=${g}`,{method:"POST",body:t})).ok?(alert(s("passwordChanged")),v(""),p(""),z(""),y(""),x(!1)):alert(s("passwordChangeError"))}catch(t){console.error(t),alert(s("passwordChangeError"))}};return e.jsxs("div",{className:"mx-auto max-w-4xl p-4",children:[e.jsx(E,{children:s("einstellungen")}),e.jsx(w,{className:"my-6"}),e.jsxs(i,{children:[e.jsx(c,{children:s("theme")}),e.jsxs("div",{className:"relative inline-flex rounded-lg p-1 bg-zinc-200 dark:bg-zinc-700",children:[e.jsx("div",{className:`absolute top-1 bottom-1 w-[calc(33.333%-0.333rem)] bg-white dark:bg-zinc-800 rounded-md shadow-sm transition-transform duration-200 ease-in-out ${a==="light"?"translate-x-0":a==="system"?"translate-x-[calc(100%+0.5rem)]":"translate-x-[calc(200%+1rem)]"}`}),e.jsx("button",{type:"button",onClick:()=>k("light"),className:`relative z-10 px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 ${a==="light"?"text-zinc-900 dark:text-black":"text-zinc-500 hover:text-zinc-700 dark:text-zinc-400 dark:hover:text-zinc-300"}`,children:"Light"}),e.jsx("button",{type:"button",onClick:()=>k("system"),className:`relative z-10 px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 ${a==="system"?"text-zinc-900 dark:text-white":"text-zinc-500 hover:text-zinc-700 dark:text-zinc-400 dark:hover:text-zinc-300"}`,children:"System"}),e.jsx("button",{type:"button",onClick:()=>k("dark"),className:`relative z-10 px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 ${a==="dark"?"text-zinc-900 dark:text-white":"text-zinc-500 hover:text-zinc-700 dark:text-zinc-400"}`,children:"Dark"})]})]}),e.jsx(w,{className:"my-6"}),e.jsxs(i,{children:[e.jsx(c,{children:s("languageLabel")}),e.jsxs("div",{className:"relative inline-flex rounded-lg p-1 bg-zinc-200 dark:bg-zinc-700",children:[e.jsx("div",{className:`absolute top-1 bottom-1 w-[calc(50%-0.25rem)] bg-white dark:bg-zinc-800 rounded-md shadow-sm transition-transform duration-200 ease-in-out ${f==="de"?"translate-x-0":"translate-x-[calc(100%+0.5rem)]"}`}),e.jsx("button",{type:"button",onClick:()=>S("de"),className:`relative z-10 px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 ${f==="de"?"text-zinc-900 dark:text-white":"text-zinc-700 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-zinc-300"}`,children:"ðŸ‡©ðŸ‡ª Deutsch"}),e.jsx("button",{type:"button",onClick:()=>S("en"),className:`relative z-10 px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 ${f==="en"?"text-zinc-900 dark:text-white":"text-zinc-700 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-zinc-300"}`,children:"ðŸ‡¬ðŸ‡§ English"})]})]}),e.jsx(w,{className:"my-6"}),e.jsx(E,{children:s("passwordReset")}),e.jsxs(i,{children:[e.jsx(c,{children:s("E-Mail")}),e.jsx(m,{value:h,onChange:t=>v(t.target.value)})]}),e.jsx(P,{type:"button",onClick:L,children:s("passwordResetButton")}),N&&e.jsxs(e.Fragment,{children:[e.jsxs(i,{children:[e.jsx(c,{children:s("token")}),e.jsx(m,{value:g,onChange:t=>p(t.target.value)})]}),e.jsxs(i,{children:[e.jsx(c,{children:s("newPassword")}),e.jsx(m,{type:"password",value:d,onChange:t=>z(t.target.value)})]}),e.jsxs(i,{children:[e.jsx(c,{children:s("confirmPassword")}),e.jsx(m,{type:"password",value:l,onChange:t=>y(t.target.value)})]}),e.jsx(P,{type:"button",onClick:M,children:s("changePassword")})]})]})});export{V as default};
