import{r as s,w as y,L as N}from"./chunk-FGUA77HG-DXx5pbNv.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{T as L,a as z,b as j,c as o,d as D,e as a}from"./table-B07IBsFq.js";import{f as m}from"./fetchApi-CVhRWstt.js";import{u as E}from"./useTranslation-DlJuNdwr.js";import{F as $}from"./CalendarDaysIcon-BMZLOEKe.js";import{F}from"./PlusCircleIcon-d1m_gb0I.js";import"./clsx-B-dksMZM.js";import"./link-DeWrvwtq.js";import"./config-Diokydjp.js";function M({title:h,titleId:r,...i},d){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":r},i),h?s.createElement("title",{id:r},h):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const R=s.forwardRef(M),J=y(function(){const{t:r}=E(),[i,d]=s.useState(null),[x,b]=s.useState(!1),[g,w]=s.useState(null),[u,k]=s.useState(null),[S,f]=s.useState(0),p=s.useRef(null);s.useEffect(()=>{m("/arbeitszeiten").then(t=>{d(t)}).catch(t=>{console.error("Fetch error:",t)})},[]),s.useEffect(()=>{m("/arbeitszeiten/timer/running").then(t=>{if(t&&t.data){const l=new Date(t.data.start).getTime();w(t.data.id),k(l),f(Math.floor((Date.now()-l)/1e3)),b(!0)}}).catch(()=>{})},[]),s.useEffect(()=>(x&&u&&(p.current=setInterval(()=>{f(Math.floor((Date.now()-u)/1e3))},1e3)),()=>{p.current&&clearInterval(p.current)}),[x,u]);const T=t=>{const l=Math.floor(t/3600),n=Math.floor(t%3600/60),c=t%60;return`${String(l).padStart(2,"0")}:${String(n).padStart(2,"0")}:${String(c).padStart(2,"0")}`},v=async()=>{if(g)try{await m(`/arbeitszeiten/timer/${g}/stop`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),b(!1),w(null),k(null),f(0),m("/arbeitszeiten").then(t=>d(t)).catch(()=>{})}catch(t){console.error("Timer Stop Fehler:",t),alert("Timer konnte nicht gestoppt werden.")}};return e.jsx("main",{children:i?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:r("workTimes")}),e.jsxs("div",{className:"flex gap-4 mt-2 text-sm text-zinc-600 dark:text-zinc-400",children:[e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx($,{className:"w-4 h-4"}),new Date().toLocaleDateString("de-DE",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx(R,{className:"w-4 h-4"}),"KW ",i.kw]})]})]}),e.jsxs(N,{to:"/neu",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[e.jsx(F,{className:"w-5 h-5"}),r("newWorkTime")]})]}),x&&e.jsxs("div",{className:"flex items-center justify-between mb-4 rounded-lg bg-green-900/40 border border-green-700 px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded-full bg-green-400 animate-pulse"}),e.jsx("span",{className:"text-green-300 font-medium",children:"Timer lÃ¤uft"}),e.jsx("span",{className:"text-green-100 font-mono font-bold text-lg",children:T(S)})]}),e.jsx("button",{type:"button",onClick:v,className:"rounded-md bg-red-600 px-4 py-1.5 text-sm font-semibold text-white hover:bg-red-500",children:"Stoppen"})]}),e.jsxs(L,{children:[e.jsx(z,{children:e.jsxs(j,{children:[e.jsx(o,{children:r("day")}),e.jsx(o,{children:r("tasks")}),e.jsx(o,{children:r("start")}),e.jsx(o,{children:r("end")}),e.jsx(o,{children:r("total")}),e.jsx(o,{children:r("edit")})]})}),e.jsx(D,{children:i.tage&&Object.entries(i.tage).flatMap(([t,l])=>l.map((n,c)=>n.ist_pause?e.jsxs(j,{className:"bg-zinc-100 dark:bg-zinc-800",children:[e.jsx(a,{}),e.jsxs(a,{colSpan:3,className:"text-center italic text-stone-500 dark:text-stone-400",children:[r("pause"),": ",n.dauer]}),e.jsx(a,{}),e.jsx(a,{})]},`${t}-pause-${c}`):e.jsxs(j,{children:[e.jsx(a,{children:c===0?t:""}),e.jsx(a,{children:n.aufgaben}),e.jsxs(a,{className:"italic text-blue-500 dark:text-blue-400",children:[n.start?new Date(n.start).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"}):"-"," "]}),e.jsx(a,{className:"italic text-red-500 dark:text-red-400",children:n.ende?new Date(n.ende).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"}):"-"}),e.jsx(a,{children:n.dauer}),e.jsx(a,{children:e.jsx(N,{to:`/arbeitszeiten/${n.id}`,className:"button-links",children:e.jsx("svg",{className:" hover:stroke-blue-300 hover:stroke-3",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",width:"20",height:"20",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 3.487a2.25 2.25 0 1 1 3.182 3.182L7.125 19.586l-4.607 1.425 1.425-4.607L16.862 3.487z"})})})})]},`${t}-${c}`)))})]})]}):e.jsx("div",{children:r("loading")})})});export{J as default};
